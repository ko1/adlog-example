name: export-run-logs

on:
  workflow_run:
    workflows:
      - sample-one
      - sample-two
      - sample-three
    types:
      - completed

permissions:
  actions: read
  contents: read

jobs:
  export:
    runs-on: ubuntu-latest
    steps:
      - name: Download logs for this run
        uses: actions/github-script@v7
        with:
          script: |
            const fs = require('fs');
            const runId = context.payload.workflow_run.id;
            const response = await github.rest.actions.downloadWorkflowRunLogs({
              owner: context.repo.owner,
              repo: context.repo.repo,
              run_id: runId,
            });
            fs.writeFileSync('logs.zip', Buffer.from(response.data));
            core.info(`Downloaded logs for run ${runId}`);
      - name: Show logs
        run: |
          unzip -q logs.zip -d logs
          find logs -type f -maxdepth 2 -print -exec cat {} \;
